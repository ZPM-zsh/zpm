#compdef zpm
#autoload

local -a _1st_arguments
_1st_arguments=(
  'upgrade:Upgrade plugins'
)

local -a _ZPM_Plugins_core__unused
for plugin in "$_ZPM_DIR/plugins/"*; do
 _ZPM_Plugins_core__unused+=$( basename "$plugin")
done

_arguments \
    '*:: :->subcmds' && return 0

if (( CURRENT == 1 )); then
  _describe -t commands "zpm subcommand" _1st_arguments
  _describe -t commands "zpm plugins" _ZPM_Plugins_core__unused
  return
fi

if (( CURRENT > 1 )); then
  case "$words[1]" in
    upgrade)
      _describe -t commands "zpm plugins" _ZPM_Plugins_3rdparty
    ;;
    *)
      _describe -t commands "zpm plugins" _ZPM_Plugins_core
    ;;
  esac
fi


return
